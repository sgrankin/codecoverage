name: 'Code Coverage Annotations'
description: 'Annotate your pull requests to show where test coverage is missing'
author: '@sgrankin'
branding:
  icon: alert-triangle
  color: orange
inputs:
  github_token:
    required: true
    description: 'Github token from workflow. This is automatically generated by github and is rotated. You can limit scopes of this token as well.'
  github_base_url:
    required: false
    description: 'Github base URL. Set this if you are using a GitHub Enterprise Server or an instance on `ghe.com`.'
    default: 'https://api.github.com'
  coverage_file_path:
    required: true
    description: 'Path to coverage file(s). Supports glob patterns (including **) and multiple paths separated by newlines.'
  coverage_format:
    required: false
    description: 'Format of coverage file. May be `lcov`, `cobertura`, or `go`.'
  step_summary:
    required: false
    description: "Write a summary to the GitHub Actions step summary. Set to 'false' to disable."
    default: 'true'
  mode:
    required: false
    description: "Operating mode: 'pr-check' (calculate delta against baseline) or 'store-baseline' (store coverage as baseline). Auto-detected if not specified."
  calculate_delta:
    required: false
    description: "Enable coverage delta calculation. Set to 'false' to disable."
    default: 'true'
  note_namespace:
    required: false
    description: "Custom namespace for git notes storage."
    default: 'coverage'
  delta_precision:
    required: false
    description: "Number of decimal places for delta display."
    default: '2'
outputs:
  coverage_percentage:
    description: 'Overall code coverage percentage'
  files_analyzed:
    description: 'Number of files with coverage data'
  annotation_count:
    description: 'Number of annotations created for uncovered lines in the PR'
  coverage_delta:
    description: 'Change in coverage percentage compared to baseline (e.g., "+2.5" or "-1.2")'
  baseline_percentage:
    description: 'Baseline coverage percentage (from git notes)'
  mode:
    description: 'The operating mode used (pr-check or store-baseline)'
runs:
  using: 'node24'
  main: 'dist/index.cjs'
